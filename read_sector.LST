C51 COMPILER V9.53.0.0   READ_SECTOR                                                       10/30/2015 13:30:43 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE READ_SECTOR
OBJECT MODULE PLACED IN read_sector.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE read_sector.c OPTIMIZE(8,SPEED) DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "main.h"
   2          #include "port.h"
   3          #include "read_sector.h"
   4          #include "spi.h"
   5          #include "SDcard.h"
   6          
   7          
   8          
   9          
  10          
  11          
  12          uint8_t read_sector(uint32_t sector_number, uint16_t sector_size, uint8_t *array_name)
  13          {
  14   1        ncs=0;
  15   1        send_command(17, sector_number);
  16   1        read_block(sector_size, array_name);
  17   1        ncs=1;
  18   1      }
*** WARNING C173 IN LINE 18 OF read_sector.c: missing return-expression
  19          
  20          uint32_t read_value_32(uint16_t offset_address, uint8_t *array_name)
  21          {
  22   1        uint32_t return_value =0;
  23   1        uint8_t temp, index;
  24   1            for (index = 0; index < 4; index++)
  25   1        {
  26   2        temp =*(array_name + offset_address + ( 3 - index));
  27   2        }
  28   1      }
*** WARNING C173 IN LINE 28 OF read_sector.c: missing return-expression
  29          
  30          uint16_t read_value_16(uint16_t offset_address, uint8_t *array_name)
  31          {
  32   1        uint16_t return_value =0;
  33   1        uint8_t temp, index;
  34   1            for (index = 0; index < 4; index++)
  35   1        {
  36   2        temp =*(array_name + offset_address + ( 3 - index));
  37   2        }
  38   1      }
*** WARNING C173 IN LINE 38 OF read_sector.c: missing return-expression
  39          
  40          uint8_t read_value_8(uint16_t offset_address, uint8_t *array_name)
  41          {
  42   1      uint8_t return_value =0;
  43   1        uint8_t temp, index;
  44   1            for (index = 0; index < 4; index++)
  45   1        {
  46   2        temp =*(array_name + offset_address + ( 3 - index));
  47   2        }
  48   1      }
*** WARNING C173 IN LINE 48 OF read_sector.c: missing return-expression
  49          
  50          uint8_t mount_drive(void)
  51          {
C51 COMPILER V9.53.0.0   READ_SECTOR                                                       10/30/2015 13:30:43 PAGE 2   

  52   1        uint8_t sector[512];
  53   1        uint8_t error_flag;
  54   1        uint32_t bpb_sector;
  55   1        
  56   1        error_flag = NO_ERRORS;
  57   1        
  58   1        read_sector(0, 512, sector);
  59   1        if(!(read8(0, sector) == 0xEB || read8(0,array) == 0xE9))
*** WARNING C206 IN LINE 59 OF read_sector.c: 'read8': missing function-prototype
*** ERROR C267 IN LINE 59 OF read_sector.c: 'read8': requires ANSI-style prototype
*** ERROR C202 IN LINE 59 OF read_sector.c: 'array': undefined identifier
  60   1        {
  61   2          bpb_sector = read32(0x01C6, sector);
  62   2        }
  63   1        else
  64   1        {
  65   2          error_flag = WRONG_RETURN;
  66   2        }
  67   1        if(error_flag == NO_ERRORS)
  68   1        {
  69   2          read_sector(bpb_sector, 512, sector);
  70   2          
  71   2          BPB_BytesPerSec = read16(0x000B, sector);
  72   2          BPB_SecPerClus `=  read8(0x000D, sector);
  73   2          BPB_RsvdSecCnt  = read16(0x000E, sector);
  74   2          BPB_NumFATs     =  read8(0x0010, sector);
  75   2          BPB_RootEntCnt  = read16(0x0011, sector);
  76   2          BPB_TotSec16    = read16(0x0013, sector);
  77   2          BPB_FATSz16     = read16(0x0016, sector);
  78   2          BPB_HiddenSec   = read32(0x001C, sector);
  79   2          BPB_TotSec32    = read32(0x0020, sector);
  80   2          BPB_Root_Clus   = read32(0x002C, sector);
  81   2          
  82   2          
  83   2          
  84   2          totSec = BPB_TotSec6
  85   2          BPB_SecPerClus = read8(0x000D, sector)
  86   2      }

C51 COMPILATION COMPLETE.  5 WARNING(S),  2 ERROR(S)
